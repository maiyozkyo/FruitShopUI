<form #form *ngIf="fg" [formGroup]="fg" [ngClass]="formClass">
  <nz-form-item *ngFor="let control of controls">
    <nz-form-label
      *ngIf="!control.hidden"
      [nzSpan]="6"
      [nzFor]="control.controlName"
      >{{ control.title }}</nz-form-label
    >
    <nz-form-control *ngIf="!control.hidden" [nzErrorTip]="control.errorMsg">
      <nz-input-group
        [nzPrefixIcon]="control.icon ?? undefined"
        [ngSwitch]="control.type"
      >
        <ng-container *ngSwitchDefault>
          <input
            nz-input
            [type]="control.type"
            [name]="control.controlName"
            [formControlName]="control.controlName"
            [placeholder]="control.placeHolder"
          />
        </ng-container>
        <ng-container *ngSwitchCase="'switch'">
          <nz-switch
            [formControlName]="control.controlName"
            ngDefaultControl
          ></nz-switch>
        </ng-container>
        <ng-container *ngSwitchCase="'select'">
          <ng-container
            *ngIf="control.isServer && control.pageInfo; else dropdownLocal"
          >
            <nz-select
              class="w-100"
              [formControlName]="control.controlName"
              (nzScrollToBottom)="dropdownServerLoadData(control)"
              [nzOptionOverflowSize]="4"
              [nzLoading]="control.pageInfo.isLoading"
              *ngIf="control.labelField && control.valueField"
            >
              <nz-option
                *ngFor="let data of control.dataSrc"
                [nzLabel]="data[control.labelField]"
                [nzValue]="data[control.valueField]"
              ></nz-option>
            </nz-select>
          </ng-container>
          <ng-template #dropdownLocal>
            <nz-select
              [formControlName]="control.controlName"
              *ngIf="control.labelField && control.valueField"
            >
              <nz-option
                *ngFor="let data of control.dataSrc"
                [nzLabel]="data[control.labelField]"
                [nzValue]="data[control.valueField]"
              ></nz-option>
            </nz-select>
          </ng-template>
        </ng-container>
        <ng-container *ngSwitchCase="'password'">
          <nz-input-group [nzSuffix]="suffixTemplate">
            <input
              nz-input
              [type]="control.hidden ? 'password' : 'text'"
              [formControlName]="control.controlName"
              [placeholder]="control.placeHolder"
            />
          </nz-input-group>
          <ng-template #suffixTemplate>
            <span
              nz-icon
              [nzType]="control.hidden ? 'eye' : 'eye-invisible'"
              (click)="control.hidden = !control.hidden"
            ></span>
          </ng-template>
        </ng-container>
      </nz-input-group>
    </nz-form-control>
  </nz-form-item>
</form>
